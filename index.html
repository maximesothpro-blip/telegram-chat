<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planning de Repas</title>
    <link rel="stylesheet" href="planning.css">
</head>
<body>
    <!-- Bouton pour rouvrir la sidebar quand elle est cachÃ©e -->
    <button class="show-sidebar-btn" id="showSidebar">â–¶ Recettes</button>

    <div class="container">
        <!-- Sidebar Recettes -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Recettes</h2>
                <div class="header-buttons">
                    <button class="refresh-btn" id="refreshRecipes" title="Actualiser les recettes">â†»</button>
                    <button class="toggle-btn" id="toggleSidebar">â—€</button>
                </div>
            </div>
            <div class="search-container">
                <input
                    type="text"
                    class="search-input"
                    id="searchRecipes"
                    placeholder="Rechercher une recette..."
                />
            </div>
            <div class="recipes-list" id="recipesList">
                <div class="loading">Chargement...</div>
            </div>
        </aside>

        <!-- Planning -->
        <main class="planning">
            <div class="planning-header">
                <h1>Planning de la Semaine</h1>
                <div class="header-controls">
                    <div class="week-navigation">
                        <button class="week-nav-btn" id="prevWeek">â† PrÃ©cÃ©dent</button>
                        <span class="week-display" id="weekDisplay">Semaine 46 - 2025</span>
                        <button class="week-nav-btn" id="nextWeek">Suivant â†’</button>
                    </div>
                    <div class="servings-control">
                        <label for="servingsInput">ğŸ‘¤ Personnes :</label>
                        <button class="servings-btn" id="decreaseServings">âˆ’</button>
                        <input type="number" id="servingsInput" min="1" max="20" value="2" />
                        <button class="servings-btn" id="increaseServings">+</button>
                    </div>
                </div>
            </div>
            <div class="calendar-grid" id="calendar">
                <!-- GÃ©nÃ©rÃ© dynamiquement -->
            </div>
        </main>

        <!-- Sidebar droite : Bot & Liste de courses -->
        <aside class="right-sidebar">
            <!-- Onglets -->
            <div class="tabs-header">
                <button class="tab-btn active" data-tab="bot">Bot</button>
                <button class="tab-btn" data-tab="shopping">Liste de courses</button>
            </div>

            <!-- Contenu Bot -->
            <div class="tab-content active" id="botTab">
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <div class="message bot-message">
                            <div class="message-content">
                                <p>Bonjour ! Je peux vous aider Ã  crÃ©er des recettes.</p>
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <form class="chat-input-form" id="chatForm">
                            <input
                                type="text"
                                class="chat-input"
                                id="messageInput"
                                placeholder="Votre message..."
                                autocomplete="off"
                            />
                            <button type="submit" class="send-button">â¤</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Contenu Liste de courses -->
            <div class="tab-content" id="shoppingTab">
                <div class="shopping-container">
                    <div class="shopping-header">
                        <button class="generate-list-btn" id="generateList">ğŸ”„ RafraÃ®chir</button>
                        <button class="settings-btn" id="settingsBtn" title="ParamÃ¨tres">âš™ï¸</button>
                        <button class="clear-list-btn" id="clearList" title="Vider la liste">ğŸ—‘ï¸</button>
                        <button class="export-list-btn" id="exportList" style="display:none;">Exporter</button>
                        <span class="save-status" id="saveStatus"></span>
                    </div>
                    <div class="shopping-content" id="shoppingContent">
                        <p class="empty-shopping">Cliquez sur "GÃ©nÃ©rer la liste" pour crÃ©er votre liste de courses.</p>
                    </div>
                    <!-- Shopping History Section -->
                    <div class="shopping-history" id="shoppingHistory">
                        <h3>ğŸ“‹ Listes prÃ©cÃ©dentes</h3>
                        <div class="history-items" id="historyItems">
                            <p class="loading">Chargement...</p>
                        </div>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Popup pour l'historique des listes de courses (gauche) -->
    <div class="history-popup" id="historyPopup">
        <div class="history-popup-content">
            <button class="close-popup" id="closeHistoryPopup">Ã—</button>
            <h2 id="historyPopupTitle">Liste de courses</h2>
            <div id="historyPopupBody"></div>
        </div>
    </div>

    <!-- Popup pour les dÃ©tails de recette -->
    <div class="recipe-popup" id="recipePopup">
        <div class="popup-content">
            <button class="close-popup" id="closePopup">Ã—</button>
            <h2 id="popupTitle"></h2>
            <div id="popupBody"></div>
        </div>
    </div>

    <!-- Popup ParamÃ¨tres Liste de Courses -->
    <div class="shopping-settings-popup" id="shoppingSettingsPopup">
        <div class="settings-popup-content">
            <button class="close-popup" id="closeSettingsPopup">Ã—</button>
            <h2>ParamÃ¨tres de la liste de courses</h2>

            <div class="settings-layout">
                <!-- Colonne gauche : Planning -->
                <div class="settings-planning">
                    <div class="settings-planning-header">
                        <h3>Planning de la semaine</h3>
                        <div class="settings-week-nav">
                            <button class="settings-week-btn" id="settingsPrevWeek">â†</button>
                            <span class="settings-week-display" id="settingsWeekDisplay">Semaine 46 - 2025</span>
                            <button class="settings-week-btn" id="settingsNextWeek">â†’</button>
                        </div>
                    </div>
                    <p class="settings-help">Cliquez sur un repas pour l'inclure ou l'exclure. <strong>Vert</strong> = semaine courante incluse, <strong>Rouge</strong> = exclue, <strong>Jaune</strong> = autre semaine (bordure verte = incluse).</p>
                    <div class="settings-actions">
                        <button class="settings-select-btn" id="settingsSelectAll">Tout inclure</button>
                        <button class="settings-select-btn" id="settingsSelectNone">Tout exclure</button>
                    </div>
                    <div class="settings-calendar" id="settingsCalendar">
                        <!-- GÃ©nÃ©rÃ© dynamiquement -->
                    </div>
                </div>

                <!-- Colonne droite : Liste Ã©ditable -->
                <div class="settings-shopping-list">
                    <h3>Liste de courses</h3>
                    <div class="settings-list-content" id="settingsListContent">
                        <p class="empty-shopping">GÃ©nÃ©rez d'abord la liste pour l'Ã©diter.</p>
                    </div>
                </div>
            </div>

            <div class="settings-footer">
                <button class="settings-reset-btn" id="resetSettings">ğŸ”„ RÃ©initialiser</button>
                <button class="settings-apply-btn" id="applySettings">Appliquer et fermer</button>
            </div>
        </div>
    </div>

    <!-- Version -->
    <div class="version-info">v3.6.0</div>

    <script src="config.js"></script>
    <script src="planning.js"></script>
</body>
</html>
